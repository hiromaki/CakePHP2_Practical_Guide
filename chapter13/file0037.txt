
<?php
// app/Controller/SecurityDataController.php
App::uses('AppController', 'Controller');

class SecurityDataController extends AppController {
    public $uses = array('User');
    public $helpers = array('Form');

    public function index() {
        if (!empty($this->request->data)) {
            $this->User->save($this->request->data); // （1）
        }
    }
}

●リスト13.23::想定どおり発行されたSQL

INSERT INTO `users` (`name`) VALUES ('cake')
※実際のSQL文を一部加工しています。


●リスト13.24::想定していないパラメータを送信する細工をしたフォーム

<!-- app/webroot/security_data.php -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
</head>
<html>

<body>
  <h1>SecurityData</h1>
  <form action="/security_data/index" method="post">
    name:<input type="text" name="data[User][name]" /><br />
    ID:<input type="text" name="data[User][id]" /><br />  <!--（1）-->
    email:<input type="text" name="data[User][email]" /><br /> <!--（2）-->
    <input type="submit" />
  </form>
</body>
</html>

●リスト13.25::想定外のSQL

SELECT COUNT(*) AS `count` FROM `users` AS `User` WHERE `User`.`id` = 1
SELECT COUNT(*) AS `count` FROM `users` AS `User` WHERE `User`.`id` = 1
SELECT COUNT(*) AS `count` FROM `users` AS `User` WHERE `User`.`id` = 1
UPDATE `users` SET `name` = 'cake', `id` = 1, `email` = 'a@example.com' WHERE `users`.`id` = '1'
※実際のSQL文を一部加工しています。
